<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Melser UI - Application Layout</title>
  <script type="module" src="/src/index.ts"></script>
  <style>
    /* Import Theme Variables */
    @import url('./src/styles/theme.css');

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      padding: 0;
      margin: 0;
      background-color: var(--me-bg);
      color: var(--me-text);
      transition: background-color 0.3s, color 0.3s;
    }

    /* Theme Toggle */
    .theme-toggle {
      background: var(--me-surface);
      padding: 0.75rem 1rem;
      border-radius: var(--me-radius);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    /* Main Application Layout */
    .app-layout {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      padding-top: 0; /* No padding needed in desktop */
    }

    .app-content-wrapper {
      display: flex;
      flex: 1;
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      padding: 2rem;
      margin-left: 260px; /* Default sidebar width */
      transition: margin-left 0.3s ease;
      overflow-y: auto;
    }

    .main-content.sidebar-collapsed {
      margin-left: 64px; /* Collapsed sidebar width */
    }

    /* Content Sections */
    .content-section {
      background: var(--me-surface);
      border-radius: var(--me-radius);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      margin-bottom: 2rem;
      border: 1px solid var(--me-border);
    }

    .content-section h1 {
      margin: 0 0 0.5rem 0;
      font-size: 2rem;
      color: var(--me-text);
    }

    .content-section h2 {
      margin: 1.5rem 0 1rem 0;
      font-size: 1.5rem;
      color: var(--me-text);
    }

    .content-section p {
      color: var(--me-text-secondary);
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    /* Cards Grid */
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-top: 1.5rem;
    }

    .card {
      background: var(--me-bg);
      border-radius: var(--me-radius);
      padding: 1.5rem;
      border: 1px solid var(--me-border);
    }

    .card h3 {
      margin: 0 0 0.75rem 0;
      color: var(--me-text);
      font-size: 1.125rem;
    }

    .card p {
      margin: 0;
      font-size: 0.875rem;
      color: var(--me-text-secondary);
    }

    /* Stats Cards */
    .stat-card {
      background: var(--me-bg);
      border-radius: var(--me-radius);
      padding: 1.5rem;
      border: 1px solid var(--me-border);
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: var(--me-radius);
      background: var(--me-primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--me-text);
      margin: 0;
    }

    .stat-label {
      font-size: 0.875rem;
      color: var(--me-text-secondary);
      margin: 0.25rem 0 0 0;
    }

    /* Table */
    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }

    .data-table th,
    .data-table td {
      text-align: left;
      padding: 1rem;
      border-bottom: 1px solid var(--me-border);
    }

    .data-table th {
      font-weight: 600;
      color: var(--me-text);
      background: var(--me-bg);
    }

    .data-table td {
      color: var(--me-text-secondary);
    }

    .data-table tr:hover {
      background: var(--me-bg);
    }

    /* Hide navbar on desktop, show on mobile/tablet */
    @media (min-width: 1024px) {
      .hide-on-desktop {
        display: none !important;
      }
      
      .app-layout {
        padding-top: 0 !important;
      }
      
      .main-content {
        padding-top: 2rem !important;
      }
      
      /* Set noNavbar attribute on sidebar when navbar is hidden */
      #main-sidebar {
        --sidebar-navbar-height: 0px;
      }
    }

    /* Show navbar on mobile/tablet */
    @media (max-width: 1023px) {
      .hide-on-desktop {
        display: block !important;
      }
      
      .app-layout {
        padding-top: 64px !important;
      }
      
      .main-content {
        padding-top: 2rem !important;
      }
      
      /* Remove noNavbar attribute on sidebar when navbar is visible */
      #main-sidebar {
        --sidebar-navbar-height: 64px;
      }
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .main-content {
        margin-left: 0 !important;
        padding: 1rem !important;
      }

      .cards-grid {
        grid-template-columns: 1fr;
      }

      .content-section {
        padding: 1.5rem;
      }

      .content-section h1 {
        font-size: 1.5rem;
      }
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .content-section {
      animation: fadeIn 0.5s ease-out;
    }

    .content-section:nth-child(2) {
      animation-delay: 0.1s;
    }

    .content-section:nth-child(3) {
      animation-delay: 0.2s;
    }

    /* Smooth Scrolling */
    html {
      scroll-behavior: smooth;
    }

    #theme-switch {
      --base-input-gap: 0;
    }

    /* Accordion Sub-items Styling */
    .accordion-subitem {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
      border-radius: var(--me-radius);
      cursor: pointer;
      transition: background-color 0.2s ease;
      color: var(--me-text);
      text-decoration: none;
      margin-top: 0.25rem;
    }

    .accordion-subitem:hover {
      background-color: var(--me-bg);
      color: var(--me-primary);
    }

    .accordion-subitem .subitem-label {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      flex: 1;
    }

    /* Custom Accordion Item Styling */
    .custom-accordion-item {
      width: 100%;
      border: 1px solid var(--me-border);
      border-radius: var(--me-radius);
      background: var(--me-bg);
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .accordion-header {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem 1rem;
      background-color: var(--me-surface);
      cursor: pointer;
      transition: background-color 0.2s ease;
      user-select: none;
    }

    .accordion-header:hover {
      background-color: var(--me-bg);
    }

    .accordion-header span {
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--me-text);
    }

    .accordion-header .chevron {
      transition: transform 0.2s ease;
      color: var(--me-text-secondary);
    }

    .custom-accordion-item[data-expanded="true"] .accordion-header .chevron {
      transform: rotate(180deg);
    }

    .custom-accordion-item[data-expanded="true"] .accordion-header {
      background-color: var(--me-bg);
    }

    .accordion-content {
      display: none;
      padding: 1rem;
    }

    .custom-accordion-item[data-expanded="true"] .accordion-content {
      display: block;
    }
  </style>
</head>

<body>
  <!-- Fixed Navbar (Only visible on mobile/tablet) -->
  <me-navbar id="main-navbar" variant="default" fixed class="hide-on-desktop">
    <me-navbar-brand slot="brand" logo="/vite.svg">
      Melser UI
    </me-navbar-brand>
    
    <div style="display: flex; gap: 1rem;">
        <me-switch id="theme-switch" label="Theme"></me-switch>
      </div>
      <me-nav-item active>
        <span slot="text">Dashboard</span>
      </me-nav-item>
      <me-nav-item>
        <span slot="text">Analytics</span>
      </me-nav-item>
      <me-nav-item>
        <span slot="text">Projects</span>
      </me-nav-item>
      <me-nav-item>
        <span slot="text">Settings</span>
      </me-nav-item>
    </div>
    
    <div slot="mobile-menu" style="display: flex; flex-direction: column; gap: 0.5rem;">
      <me-nav-item active>
        <span slot="text">Dashboard</span>
      </me-nav-item>
      <me-nav-item>
        <span slot="text">Analytics</span>
      </me-nav-item>
      <me-nav-item>
        <span slot="text">Projects</span>
      </me-nav-item>
      <me-nav-item>
        <span slot="text">Settings</span>
      </me-nav-item>
      <hr style="border: 0; border-top: 1px solid var(--me-border); margin: 0.5rem 0;">
      <button style="padding: 0.5rem 1rem; background: var(--me-primary); color: white; border: none; border-radius: var(--me-radius); cursor: pointer;">Sign In</button>
    </div>
    
    <div slot="actions" style="display: flex; gap: 1rem;">
      <me-icon-button label="Notifications">
        <me-icon name="bell" slot="icon"></me-icon>
      </me-icon-button>
      <button style="padding: 0.5rem 1rem; background: var(--me-primary); color: white; border: none; border-radius: var(--me-radius); cursor: pointer;">Sign In</button>
    </div>
  </me-navbar>

  <!-- Fixed Sidebar with Accordion Navigation -->
  <!-- noNavbar is set dynamically based on screen size -->
  <me-sidebar id="main-sidebar" position="left" fixed navbar-height="64">
    <div class="sidebar-content" style="padding: 1rem; overflow-y: auto;">
      <div style="margin-top: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
        <!-- Dashboard Navigation -->
        <me-nav-item data-section="overview">
          <me-icon name="grid" slot="icon"></me-icon>
          <span slot="text">Dashboard</span>
        </me-nav-item>

        <!-- Documentation Accordion Group -->
        <me-accordion id="sidebar-docs-accordion">
          <div class="custom-accordion-item" data-value="doc1" data-section="doc1">
            <div class="accordion-header">
              <span>Getting Started</span>
              <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
            </div>
            <div class="accordion-content">
              <div class="accordion-subitem" data-section="doc1">
                <span class="subitem-label">Introduction</span>
              </div>
              <div class="accordion-subitem" data-section="doc1">
                <span class="subitem-label">Quick Start</span>
              </div>
            </div>
          </div>
          
          <div class="custom-accordion-item" data-value="doc2" data-section="doc2">
            <div class="accordion-header">
              <span>Installation</span>
              <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
            </div>
            <div class="accordion-content">
              <div class="accordion-subitem" data-section="doc2">
                <span class="subitem-label">NPM Install</span>
              </div>
              <div class="accordion-subitem" data-section="doc2">
                <span class="subitem-label">Yarn Install</span>
              </div>
            </div>
          </div>
          
          <div class="custom-accordion-item" data-value="doc3" data-section="doc3">
            <div class="accordion-header">
              <span>API Reference</span>
              <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
            </div>
            <div class="accordion-content">
              <div class="accordion-subitem" data-section="doc3">
                <span class="subitem-label">Components API</span>
              </div>
              <div class="accordion-subitem" data-section="doc3">
                <span class="subitem-label">Utilities</span>
              </div>
            </div>
          </div>
          
          <div class="custom-accordion-item" data-value="doc4" data-section="doc4">
            <div class="accordion-header">
              <span>Components</span>
              <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
            </div>
            <div class="accordion-content">
              <div class="accordion-subitem" data-section="doc4">
                <span class="subitem-label">Buttons</span>
              </div>
              <div class="accordion-subitem" data-section="doc4">
                <span class="subitem-label">Forms</span>
              </div>
              <div class="accordion-subitem" data-section="doc4">
                <span class="subitem-label">Navigation</span>
              </div>
            </div>
          </div>
        </me-accordion>

        <!-- FAQ Accordion Group -->
        <me-accordion id="sidebar-faq-accordion">
          <div class="custom-accordion-item" data-value="faq1" data-section="faq1">
            <div class="accordion-header">
              <span>What is Melser UI?</span>
              <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
            </div>
            <div class="accordion-content">
              <div class="accordion-subitem" data-section="faq1">
                <span class="subitem-label">Overview</span>
              </div>
            </div>
          </div>
          
          <div class="custom-accordion-item" data-value="faq2" data-section="faq2">
            <div class="accordion-header">
              <span>How do I get started?</span>
              <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
            </div>
            <div class="accordion-content">
              <div class="accordion-subitem" data-section="faq2">
                <span class="subitem-label">Getting Started Guide</span>
              </div>
            </div>
          </div>
          
          <div class="custom-accordion-item" data-value="faq3" data-section="faq3">
            <div class="accordion-header">
              <span>Is Melser UI customizable?</span>
              <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
            </div>
            <div class="accordion-content">
              <div class="accordion-subitem" data-section="faq3">
                <span class="subitem-label">Theming Guide</span>
              </div>
            </div>
          </div>
          
          <div class="custom-accordion-item" data-value="faq4" data-section="faq4">
            <div class="accordion-header">
              <span>Does it support dark mode?</span>
              <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
            </div>
            <div class="accordion-content">
            </div>
          </div>
        </me-accordion>

        <me-nav-item data-section="overview">
          <me-icon name="star" slot="icon"></me-icon>
          <span slot="text">Favorites</span>
        </me-nav-item>

        <me-nav-item data-section="overview">
          <me-icon name="settings" slot="icon"></me-icon>
          <span slot="text">Settings</span>
        </me-nav-item>
      </div>
    </div>
  </me-sidebar>

  <!-- Main Content -->
  <div class="app-layout">
    <div class="app-content-wrapper">
      <div class="main-content" id="main-content">
        <div class="content-section" id="overview">
          <h1>Dashboard Overview</h1>
          <p>Welcome to your Melser UI application dashboard. Here you can find an overview of your projects, analytics, and recent activity.</p>
        </div>

        <div class="content-section" id="statistics">
          <h2>Statistics</h2>
          <div class="cards-grid">
            <div class="stat-card">
              <div class="stat-icon">
                <me-icon name="eye" color="success"></me-icon>
              </div>
              <div>
                <p class="stat-value">2,451</p>
                <p class="stat-label">Total Views</p>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon">
                <me-icon name="users" color="primary"></me-icon>
              </div>
              <div>
                <p class="stat-value">1,892</p>
                <p class="stat-label">Active Users</p>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon">
                <me-icon name="file" color="warning"></me-icon>
              </div>
              <div>
                <p class="stat-value">384</p>
                <p class="stat-label">Documents</p>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon">
                <me-icon name="check" color="danger"></me-icon>
              </div>
              <div>
                <p class="stat-value">94%</p>
                <p class="stat-label">Completion Rate</p>
              </div>
            </div>
          </div>
        </div>

        <div class="content-section" id="activity">
          <h2>Recent Activity</h2>
          <table class="data-table">
            <thead>
              <tr>
                <th>Project</th>
                <th>Status</th>
                <th>Progress</th>
                <th>Last Updated</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Website Redesign</td>
                <td><span style="color: #10b981; font-weight: 600;">In Progress</span></td>
                <td>75%</td>
                <td>2 hours ago</td>
              </tr>
              <tr>
                <td>Mobile App Development</td>
                <td><span style="color: #f59e0b; font-weight: 600;">Review</span></td>
                <td>90%</td>
                <td>5 hours ago</td>
              </tr>
              <tr>
                <td>Database Migration</td>
                <td><span style="color: #3b82f6; font-weight: 600;">Completed</span></td>
                <td>100%</td>
                <td>1 day ago</td>
              </tr>
              <tr>
                <td>API Integration</td>
                <td><span style="color: #10b981; font-weight: 600;">In Progress</span></td>
                <td>45%</td>
                <td>2 days ago</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="content-section" id="actions">
          <h2>Quick Actions</h2>
          <div class="cards-grid">
            <div class="card">
              <h3>üìù Create Project</h3>
              <p>Start a new project and define its goals and milestones.</p>
            </div>
            <div class="card">
              <h3>üìä View Analytics</h3>
              <p>Analyze your data and track performance metrics.</p>
            </div>
            <div class="card">
              <h3>üë• Manage Team</h3>
              <p>Add or remove team members and assign roles.</p>
            </div>
            <div class="card">
              <h3>‚öôÔ∏è Configure Settings</h3>
              <p>Customize your application preferences and configurations.</p>
            </div>
          </div>
        </div>
        <!-- Accordion Navigation System -->
        <div class="content-section" id="accordion-navigation">
          <h2>Accordion Navigation System</h2>
          <p>The accordion system now supports navigation with shared state across different groups. Each accordion group can have one selected item, allowing you to navigate between sections easily.</p>
          
          <div class="cards-grid">
            <div class="card">
              <h3>üìö Documentation</h3>
              <p>Explore documentation topics with accordion navigation.</p>
            </div>
            <div class="card">
              <h3>üìä Dashboard</h3>
              <p>Navigate dashboard sections using accordions.</p>
            </div>
            <div class="card">
              <h3>‚öôÔ∏è Settings</h3>
              <p>Access different configuration groups.</p>
            </div>
          </div>
        </div>

        <!-- Accordion Sections with Navigation -->
        <div class="content-section" id="accordions">
          <h2>Documentation (Accordion Navigation)</h2>
          <me-accordion id="docs-accordion">
            <div class="custom-accordion-item" data-value="doc1" data-section="doc1" data-expanded="true">
              <div class="accordion-header">
                <span>Getting Started</span>
                <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
              </div>
              <div class="accordion-content">
                <p>Welcome to Melser UI! This guide will help you get started with our component library.</p>
              </div>
            </div>
            <div class="custom-accordion-item" data-value="doc2" data-section="doc2">
              <div class="accordion-header">
                <span>Installation</span>
                <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
              </div>
              <div class="accordion-content">
                <p>Install Melser UI using npm or yarn: <code>npm install melser-ui</code></p>
              </div>
            </div>
            <div class="custom-accordion-item" data-value="doc3" data-section="doc3">
              <div class="accordion-header">
                <span>API Reference</span>
                <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
              </div>
              <div class="accordion-content">
                <p>Complete API documentation for all Melser UI components.</p>
              </div>
            </div>
            <div class="custom-accordion-item" data-value="doc4" data-section="doc4">
              <div class="accordion-header">
                <span>Components</span>
                <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
              </div>
              <div class="accordion-content">
                <p>Available components in Melser UI: Buttons, Forms, Navigation, and Data Display.</p>
              </div>
            </div>
          </me-accordion>
        </div>

        <div class="content-section" id="faq-accordions">
          <h2>FAQ (Separate Group)</h2>
          <me-accordion id="faq-accordion">
            <div class="custom-accordion-item" data-value="faq1" data-section="faq1">
              <div class="accordion-header">
                <span>What is Melser UI?</span>
                <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
              </div>
              <div class="accordion-content">
                <p>Melser UI is a comprehensive component library built with LitElement, providing accessible and customizable UI components for modern web applications.</p>
              </div>
            </div>
            <div class="custom-accordion-item" data-value="faq2" data-section="faq2">
              <div class="accordion-header">
                <span>How do I get started?</span>
                <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
              </div>
              <div class="accordion-content">
                <p>Simply install the package using npm or yarn, import the components you need, and start building. Check our documentation for detailed installation guides.</p>
              </div>
            </div>
            <div class="custom-accordion-item" data-value="faq3" data-section="faq3">
              <div class="accordion-header">
                <span>Is Melser UI customizable?</span>
                <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
              </div>
              <div class="accordion-content">
                <p>Yes! Melser UI provides extensive theming capabilities through CSS custom properties and a built-in theme manager for easy customization.</p>
              </div>
            </div>
            <div class="custom-accordion-item" data-value="faq4" data-section="faq4">
              <div class="accordion-header">
                <span>Does it support dark mode?</span>
                <me-icon name="chevron-down" size="sm" class="chevron"></me-icon>
              </div>
              <div class="accordion-content">
                <p>Absolutely! Melser UI includes built-in dark mode support that can be toggled programmatically or based on system preferences.</p>
              </div>
            </div>
          </me-accordion>
        </div>

        <div class="content-section" id="doc1">
          <h1>Getting Started</h1>
          <p>Welcome to Melser UI! This guide will help you get started with our component library.</p>
          <h2>Installation</h2>
          <p>Install Melser UI using npm or yarn:</p>
          <div class="card" style="margin-top: 1rem;">
            <code style="background: var(--me-bg); padding: 1rem; display: block; border-radius: var(--me-radius); font-family: monospace;">npm install melser-ui</code>
          </div>
        </div>

        <div class="content-section" id="doc2">
          <h2>Installation Guide</h2>
          <p>Follow these steps to integrate Melser UI into your project:</p>
          <ol style="margin-left: 1.5rem; color: var(--me-text-secondary);">
            <li style="margin-bottom: 0.5rem;">Install the package</li>
            <li style="margin-bottom: 0.5rem;">Import components</li>
            <li style="margin-bottom: 0.5rem;">Configure theme</li>
            <li>Start building!</li>
          </ol>
        </div>

        <div class="content-section" id="doc3">
          <h2>API Reference</h2>
          <p>Complete API documentation for all Melser UI components.</p>
          <div class="card" style="margin-top: 1rem;">
            <h3>Components</h3>
            <p>Explore our 20+ UI components including buttons, forms, navigation, and more.</p>
          </div>
        </div>

        <div class="content-section" id="doc4">
          <h2>Components</h2>
          <p>Available components in Melser UI:</p>
          <div class="cards-grid">
            <div class="card">
              <h3>Buttons</h3>
              <p>Various button styles and variants.</p>
            </div>
            <div class="card">
              <h3>Forms</h3>
              <p>Input fields, selects, checkboxes, and more.</p>
            </div>
            <div class="card">
              <h3>Navigation</h3>
              <p>Sidebar, navbar, and accordion components.</p>
            </div>
            <div class="card">
              <h3>Data Display</h3>
              <p>Tables, cards, and statistical widgets.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { registerComponent, MelserSwitch, setTheme } from '/src/index.ts';

    // Theme Management
    function initTheme() {
      const themeSwitch = document.getElementById('theme-switch');
      if (!themeSwitch) return;

      // Check system preference
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        themeSwitch.value = true;
        document.documentElement.setAttribute('data-theme', 'dark');
        setTheme('dark');
      }

      themeSwitch.addEventListener('ui:change', (e) => {
        const isDark = e.detail.value;
        document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
        setTheme(isDark ? 'dark' : 'light');
      });
    }

    // Sidebar and Navbar connection
    function initSidebar() {
      const sidebar = document.getElementById('main-sidebar');
      const mainContent = document.getElementById('main-content');

      if (!sidebar || !mainContent) return;

      // Listen for sidebar collapse events
      sidebar.addEventListener('sidebar-toggle', (e) => {
        const collapsed = e.detail.collapsed;
        if (collapsed) {
          mainContent.classList.add('sidebar-collapsed');
        } else {
          mainContent.classList.remove('sidebar-collapsed');
        }
      });

      // Also listen to collapse and expand events
      sidebar.addEventListener('sidebar-collapse', () => {
        mainContent.classList.add('sidebar-collapsed');
      });

      sidebar.addEventListener('sidebar-expand', () => {
        mainContent.classList.remove('sidebar-collapsed');
      });

      // Handle window resize
      window.addEventListener('resize', () => {
        const isMobile = window.innerWidth <= 768;
        const isTablet = window.innerWidth <= 1023;
        
        if (isMobile) {
          // On mobile, remove collapsed state
          mainContent.classList.remove('sidebar-collapsed');
        }
        
        // On desktop (> 1024px), ensure proper layout
        if (!isTablet) {
          mainContent.classList.remove('sidebar-collapsed');
        }
      });
    }

    // Tab Navigation System
    function initTabNavigation() {
      const sections = document.querySelectorAll('.content-section');

      // Map section IDs to tab values
      const sectionToTabMap = new Map();
      const tabToSectionMap = new Map();
      const tabElementMap = new Map();

      // Update active tab based on hash
      function updateActiveNav() {
        const hash = window.location.hash || '#overview';
        const sectionId = hash.replace('#', '');

        // Update all tabs
        sectionToTabMap.forEach((tabInfo, secId) => {
          if (secId === sectionId) {
            tabInfo.tab.value = sectionId;
          }
        });
      }

      // Update active nav item based on scroll position
      function updateActiveNavOnScroll() {
        const scrollPosition = window.scrollY + 100; // Offset for better detection

        let currentSection = 'overview';
        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.offsetHeight;

          if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
            currentSection = section.id;
          }
        });

        // Update hash without triggering scroll
        if (window.location.hash !== '#' + currentSection) {
          history.replaceState(null, null, '#' + currentSection);
          updateActiveNav();
        }
      }

      // Handle hash change
      window.addEventListener('hashchange', () => {
        updateActiveNav();
        const hash = window.location.hash || '#overview';
        const targetElement = document.querySelector(hash);
        if (targetElement) {
          targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });


      // Listen to scroll events with debounce
      let scrollTimeout;
      window.addEventListener('scroll', () => {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(updateActiveNavOnScroll, 50);
      });

      // Initial setup
      updateActiveNav();
      updateActiveNavOnScroll();

      console.log('üîë Tab navigation initialized');
    }

    // Navigation System with Event Delegation
    function initNavigationSystem() {
      // Add click handlers to all sub-items
      const subItems = document.querySelectorAll('.accordion-subitem');
      subItems.forEach(subItem => {
        subItem.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          
          const sectionId = subItem.dataset.section;
          if (sectionId) {
            console.log('üìå Sub-item clicked:', sectionId);
            const targetElement = document.getElementById(sectionId);
            if (targetElement) {
              targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          }
        });
      });

      console.log('üß≠ Navigation system initialized with event delegation');
    }

    // Accordion System with Event Delegation
    function initAccordionSystem() {
      // Add event delegation for all accordions
      document.addEventListener('click', (e) => {
        const header = e.target.closest('.accordion-header');
        if (!header) return;

        const accordionItem = header.closest('.custom-accordion-item');
        if (!accordionItem) return;

        const accordion = accordionItem.closest('me-accordion');
        if (!accordion) return;

        // Check if this accordion allows multiple open items
        const allowMultiple = accordion === document.getElementById('sidebar-docs-accordion') || 
                           accordion === document.getElementById('sidebar-faq-accordion');
        
        const isExpanded = accordionItem.dataset.expanded === 'true';
        
        if (!allowMultiple) {
          // Close all other items in the same accordion
          const allItems = accordion.querySelectorAll(':scope > .custom-accordion-item');
          allItems.forEach(item => {
            item.dataset.expanded = 'false';
          });
        }

        // Toggle current item
        accordionItem.dataset.expanded = isExpanded ? 'false' : 'true';

        console.log('üîΩ Accordion toggled:', accordionItem.dataset.value, 'expanded:', !isExpanded);
      });

      console.log('üì¶ Accordion system initialized with event delegation');
    }

    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      initTheme();
      initSidebar();
      initTabNavigation();
      initNavigationSystem();
      initAccordionSystem();

      console.log('‚úÖ Melser UI Application initialized successfully');
      console.log('üì± Resize window below 768px to see mobile responsive behavior');
      console.log('üîë Use tab navigation or scroll to see active section highlighting');
      console.log('üß≠ Use sidebar accordions to navigate to different sections');
      console.log('üìö Accordions now use simple event delegation - users handle their own events');
    });

    // Register custom components (if needed)
    registerComponent('custom-brand-switch', MelserSwitch);
  </script>
</body>

</html>
